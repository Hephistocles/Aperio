extends ./paper
block navigation
	if paper
		p
			a(href="/paper/"+paper.document_id) Summary 
			| | Discussion 

block paper_content
	if logged_in
		form(action="/api/responses/", method="post")
			.shadow

				div(id="wysihtml5-toolbar", style="display: none;")
					a(data-wysihtml5-command="bold") bold
					a(data-wysihtml5-command="italic") italic
					a(data-wysihtml5-command="insertImage") insertImage
					a(data-wysihtml5-command="insertOrderedList") insertOrderedList
					a(data-wysihtml5-command="insertUnorderedList") insertUnorderedList
					a(data-wysihtml5-command="justifyCenter") justifyCenter
					a(data-wysihtml5-command="justifyLeft") justifyLeft
					a(data-wysihtml5-command="justifyRight") justifyRight
					a(data-wysihtml5-command="createLink") insert link
					div(data-wysihtml5-dialog="createLink",style="display: none;")
						label Link:
							input(data-wysihtml5-dialog-field="href",value="http://",class="text")
						a(data-wysihtml5-dialog-action="save") OK
						a(data-wysihtml5-dialog-action="cancel") Cancel
				textarea(name="response_content" id="response-textarea", placeholder="Enter your text ...",autofocus,style="min-height:150px")
				a Save Draft
				a Clear Draft
				input(type="hidden", name="response_type", value=3)
				input(type="hidden", name="document_id", value=paper.document_id)
				input(type="submit", value="Submit Response")
		script.
			var editor = new wysihtml5.Editor("response-textarea",{toolbar:"wysihtml5-toolbar",parserRules:wysihtml5ParserRules});

	if responses
		each response in responses
			.response.shadow(style="min-height:170px; margin-top:35px;")
				.side
					img(src=response.picture_url, style="height:150px;width:auto;border-radius:50%;border:5px solid #FFF;position: absolute;top: -35px;left: -35px;", class="icon-btn")
					img(src="/img/arrow.png", style="-webkit-transform: rotate(270deg);", class="icon-btn")
					img(src="/img/arrow.png", style="-webkit-transform: rotate(90deg);", class="icon-btn")
				.response-header(style="padding-left:80px")
					h2 #{response["real_name"]}
				button(type="button" class="showhide-btn") Show
				div(style="display:none;")
					.response-content
						p #{response.content}
						.comments
							h3 Comments
							if response.comments
								each comment in response.comments
									.comment
										span
											b #{comment["real_name"]} 
											| #{comment["comment_text"]} 
											span(style="color:grey;") - #{comment["niceTime"]}
	else
		p there are no responses to display